<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Ch√° de Beb√™ ‚Ä¢ Convite & Lista</title>
  <meta name="description" content="Convite do ch√° de beb√™ + lista de presentes com reserva por WhatsApp e PIX" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    :root {
      --brand:#f8a5c2; /* rosa rose */
      --brand2:#b8e0c7; /* verde folha suave */
      --ink:#1f2937;
    }
    html, body { font-family: 'Poppins', system-ui, -apple-system, Segoe UI, Roboto, sans-serif; color: var(--ink); }
    .bg-baby { background: linear-gradient(180deg, #fff8fb 0%, #f9fff9 100%), url('background-leaves.png'); background-size: cover; background-attachment: fixed; }
    .card { background: white; border-radius: 1rem; box-shadow: 0 10px 30px rgba(30,41,59,.08); }
    .ribbon { position: relative; }
    .ribbon:before { content:""; position:absolute; inset:-2px; border-radius:1.05rem; padding:2px; background:linear-gradient(135deg, var(--brand), var(--brand2)); -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0); -webkit-mask-composite: xor; mask-composite: exclude; }
    .media { position: relative; width: 100%; padding-top: 66.666%; border-radius: 0.75rem; overflow: hidden; background:#fff; }
    .media > img { position:absolute; inset:0; width:100%; height:100%; object-fit:cover; }
    .btn-grad { background:linear-gradient(135deg, var(--brand), var(--brand2)); color:white; }
  </style>
</head>
<body class="bg-baby">
  <header class="px-4 sm:px-6 lg:px-8 pt-10 pb-6">
    <div class="max-w-5xl mx-auto card ribbon overflow-hidden">
      <div class="grid md:grid-cols-2">
        <div class="p-8 md:p-10">
          <p class="text-sm tracking-widest text-slate-500">VOC√ä EST√Å CONVIDADO(A)</p>
          <h1 class="text-3xl sm:text-4xl md:text-5xl font-extrabold leading-tight mt-2">
            Ch√° de Beb√™ <span class="text-[var(--brand)]">da nossa menina</span>
          </h1>
          <p class="mt-4 text-slate-600">Venha celebrar conosco a chegada da nossa princesa! Teremos momentos especiais, muito carinho e muitas risadas. üå∏</p>
          <dl class="mt-6 grid grid-cols-1 sm:grid-cols-2 gap-4 text-sm">
            <div class="p-4 rounded-xl bg-white/60 border border-slate-200">
              <dt class="text-slate-500">Data & Hora</dt>
              <dd id="dtText" class="font-semibold">S√°bado, 12 de outubro, 15:30</dd>
            </div>
            <div class="p-4 rounded-xl bg-white/60 border border-slate-200">
              <dt class="text-slate-500">Local</dt>
              <dd class="font-semibold">Sal√£o de Festas ‚Äî Condom√≠nio</dd>
            </div>
            <div class="p-4 rounded-xl bg-white/60 border border-slate-200">
              <dt class="text-slate-500">Traje/Clima</dt>
              <dd class="font-semibold">Confort√°vel e em tons claros/ros√©</dd>
            </div>
            <div class="p-4 rounded-xl bg-white/60 border border-slate-200">
              <dt class="text-slate-500">Confirma√ß√£o</dt>
              <dd class="font-semibold">Confirme no WhatsApp üíï</dd>
            </div>
          </dl>
          <div class="mt-6 flex flex-wrap gap-3">
            <a id="rsvpBtn" href="#rsvp" class="inline-flex items-center justify-center rounded-xl px-5 py-3 text-white font-semibold" style="background:linear-gradient(135deg, var(--brand), var(--brand2));">Confirmar presen√ßa</a>
            <a href="#lista" class="inline-flex items-center justify-center rounded-xl px-5 py-3 border font-semibold border-slate-300 text-slate-700 hover:bg-white">Ver lista de presentes</a>
          </div>
          <div class="mt-6 text-sm text-slate-500">Falta <span id="countdown" class="font-semibold text-slate-700">‚Äî</span> para o grande dia!</div>
        </div>
        <div class="order-first md:order-last h-64 md:h-auto bg-[url('hero-baby-girl.jpeg')] bg-cover bg-center rounded-t-xl md:rounded-l-none md:rounded-r-xl"></div>
      </div>
    </div>
  </header>

  <main class="px-4 sm:px-6 lg:px-8 pb-24">
    <div class="max-w-5xl mx-auto space-y-10">
      <section id="pix" class="card p-6 md:p-8">
        <h2 class="text-2xl font-bold">Quero presentear em PIX</h2>
        <p class="mt-2 text-slate-600">Se preferir, voc√™ pode ajudar com qualquer valor. üíñ</p>
        <div class="mt-4 grid sm:grid-cols-[1fr_auto] gap-4 items-center">
          <div>
            <div class="text-sm text-slate-500">Chave PIX</div>
            <div id="pixKey" class="text-lg font-semibold select-all break-all">SUA_CHAVE_PIX_AQUI</div>
          </div>
          <button class="px-4 py-2 rounded-lg font-semibold border border-slate-300 hover:bg-white" onclick="copyPix()">Copiar chave</button>
        </div>
        <div class="mt-3 text-xs text-slate-500">Banco: <span class="font-medium">Bradesco</span></div>
        <div class="mt-3 flex items-center gap-4">
          <img src="bradesco.png" alt="QR Code PIX" class="w-40 h-40 object-contain rounded-md border border-slate-200 bg-white" />
          <div class="text-xs text-slate-500">Voc√™ pode <strong>escanear o QR</strong> pelo app do banco ou usar a chave acima.</div>
        </div>
      </section>

      <section id="lista" class="card p-6 md:p-8">
        <div class="flex items-center justify-between gap-4 flex-wrap">
          <h2 class="text-2xl font-bold">Lista de Presentes</h2>
          <div class="text-sm text-slate-500">Carregando de <code>produtos.xlsx</code></div>
        </div>
        <p class="mt-2 text-slate-600">Escolha um presente e clique em <span class="font-medium">Reservar</span> para avisar no WhatsApp. Voc√™ tamb√©m pode marcar um item como reservado (salvo apenas no seu navegador).</p>
        <div id="giftGrid" class="mt-6 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5"></div>
      </section>

      <section id="mapa" class="card p-6 md:p-8">
        <h2 class="text-2xl font-bold">Como chegar</h2>
        <p class="mt-2 text-slate-600">Clique para abrir no Google Maps.</p>
        <a id="mapLink" target="_blank" class="inline-flex mt-4 items-center justify-center rounded-xl px-5 py-3 text-white font-semibold" style="background:linear-gradient(135deg, var(--brand), var(--brand2));">Abrir no Google Maps</a>
      </section>

      <section id="rsvp" class="card p-6 md:p-8">
        <h2 class="text-2xl font-bold">Confirma√ß√£o de presen√ßa</h2>
        <p class="mt-2 text-slate-600">Confirme no WhatsApp para nos organizarmos melhor. Obrigado! üíñ</p>
        <a id="whatsBtn" target="_blank" class="inline-flex mt-4 items-center justify-center rounded-xl px-5 py-3 text-white font-semibold" style="background:linear-gradient(135deg, var(--brand), var(--brand2));">Enviar mensagem no WhatsApp</a>
      </section>
    </div>
  </main>

  <footer class="text-center text-xs text-slate-500 pb-10">
    Feito com amor ‚Äî ¬© <span id="ano"></span>
  </footer>

  <script>
    const CONFIG = {
      datetime: '2025-10-12T15:30:00',
      datetimeText: 'S√°bado, 12 de outubro, 15:30',
      mapsQuery: 'Residencial Nature Ville, Cabula, Salvador - BA',
      pixKey: 'SUA_CHAVE_PIX_AQUI',
      whatsapp: '5571999999999',
      rsvpText: 'Ol√°! Quero confirmar presen√ßa no Ch√° de Beb√™ da princesa. Meu nome √©: ',
      reserveText: 'Ol√°! Quero reservar este presente do ch√° de beb√™: ',
      defaultSource: 'xlsx'
    };

    const fmtBRL = v => (v==null||v==='') ? '-' : Number(v).toLocaleString('pt-BR',{style:'currency',currency:'BRL'});

    function startCountdown() {
      const el = document.getElementById('countdown');
      const target = new Date(CONFIG.datetime);
      function tick(){
        const now = new Date();
        let diff = Math.max(0, target - now);
        const d = Math.floor(diff / 86400000); diff -= d*86400000;
        const h = Math.floor(diff / 3600000);  diff -= h*3600000;
        const m = Math.floor(diff / 60000);    diff -= m*60000;
        const s = Math.floor(diff / 1000);
        el.textContent = d + 'd ' + h + 'h ' + m + 'm ' + s + 's';
      }
      tick(); setInterval(tick, 1000);
    }

    function copyPix(){ navigator.clipboard.writeText(CONFIG.pixKey).then(function(){ alert('Chave PIX copiada!'); }); }

    function buildLinks() {
      document.getElementById('dtText').textContent = CONFIG.datetimeText;
      document.getElementById('ano').textContent = new Date().getFullYear();
      document.getElementById('rsvpBtn').href = 'https://wa.me/' + CONFIG.whatsapp + '?text=' + encodeURIComponent(CONFIG.rsvpText);
      document.getElementById('whatsBtn').href = 'https://wa.me/' + CONFIG.whatsapp + '?text=' + encodeURIComponent(CONFIG.rsvpText);
      document.getElementById('mapLink').href = 'https://www.google.com/maps/search/?api=1&query=' + encodeURIComponent(CONFIG.mapsQuery);
      document.getElementById('pixKey').textContent = CONFIG.pixKey;
    }

    const LOCAL_KEY = 'babyshower_reserved_v2';
    const grid = document.getElementById('giftGrid');
    const reserved = JSON.parse(localStorage.getItem(LOCAL_KEY) || '{}');

    function cardTpl(item, idx){
      var isRes = !!reserved[item.nome];
      var img = item.img || item.imagem || item.foto || '';
      var val = (item.valor!=='' && item.valor!=null) ? fmtBRL(item.valor) : '-';
      return (
        '<article class="p-3 rounded-xl border border-slate-200 bg-white/80 hover:shadow-md transition">' +
          '<div class="media mb-3">' +
            '<img src="' + img + '" alt="' + (item.nome||'') + '" loading="lazy" onerror="this.style.opacity=0.2" />' +
          '</div>' +
          '<h3 class="font-semibold leading-snug">' + (item.nome||'') + '</h3>' +
          '<p class="text-slate-600 text-sm">' + (item.detalhe||'') + '</p>' +
          '<div class="mt-2 font-semibold">' + val + '</div>' +
          '<div class="mt-3 flex items-center gap-2">' +
            '<button data-idx="' + idx + '" class="toggleRes px-3 py-1 rounded-lg border ' + (isRes? 'bg-green-50 border-green-300 text-green-700' : 'border-slate-300 text-slate-700 hover:bg-white') + '">' +
              (isRes? 'Marcado (local)' : 'Marcar') +
            '</button>' +
            '<a target="_blank" class="btn-grad inline-flex items-center justify-center rounded-lg px-3 py-1 font-medium" href="https://wa.me/' + CONFIG.whatsapp + '?text=' + encodeURIComponent(CONFIG.reserveText) + encodeURIComponent(item.nome||'') + '%20-%20' + encodeURIComponent(item.detalhe||'') + '">Reservar</a>' +
          '</div>' +
        '</article>'
      );
    }

    async function loadFromXLSX(){
      const res = await fetch('produtos.xlsx');
      const arrayBuffer = await res.arrayBuffer();
      const workbook = XLSX.read(arrayBuffer, {type:'array'});
      const sheet = workbook.Sheets[workbook.SheetNames[0]];
      const rows = XLSX.utils.sheet_to_json(sheet, {defval:'', raw:true});
      return rows.map(function(r){ return {
        nome: r.nome||r.Nome||r.item||r.Item||'',
        detalhe: r.detalhe||r.Detalhe||r.descricao||r['Descri√ß√£o']||'',
        valor: r.valor||r.preco||r['Pre√ßo']||r.Valor||'',
        img: r.img||r.imagem||r.foto||r.Foto||r.Imagem||''
      }; }).filter(function(x){ return x.nome; });
    }

    async function bootGifts(){
      const list = await loadFromXLSX();
      grid.innerHTML = list.map(function(it,i){ return cardTpl(it,i); }).join('');
      grid.querySelectorAll('.toggleRes').forEach(function(btn){
        btn.addEventListener('click', function(e){
          const idx = +e.currentTarget.getAttribute('data-idx');
          const item = list[idx];
          if (reserved[item.nome]) delete reserved[item.nome]; else reserved[item.nome] = true;
          localStorage.setItem(LOCAL_KEY, JSON.stringify(reserved));
          bootGifts();
        });
      });
    }

    (function init(){
      buildLinks();
      startCountdown();
      bootGifts();
    })();
  </script>
</body>
</html>
